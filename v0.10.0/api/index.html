<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>The RLEVectors Types and Methods · RLEVectors</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">RLEVectors</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">RLEVectors</a></li><li><a class="tocitem" href="../NEWS/">-</a></li><li><a class="tocitem" href="../TODO/">TODO list</a></li><li class="is-active"><a class="tocitem" href>The RLEVectors Types and Methods</a><ul class="internal"><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Types"><span>Types</span></a></li><li><a class="tocitem" href="#Standard-Vector-API-methods"><span>Standard Vector API methods</span></a></li><li><a class="tocitem" href="#Working-with-runs"><span>Working with runs</span></a></li><li><a class="tocitem" href="#Working-with-run-boundaries-/-ranges"><span>Working with run boundaries / ranges</span></a></li><li><a class="tocitem" href="#split-and-tapply-like-operations"><span>split and tapply -like operations</span></a></li><li><a class="tocitem" href="#Summaries-on-RLEVectors"><span>Summaries on RLEVectors</span></a></li><li><a class="tocitem" href="#Going-back-and-forth-to-R"><span>Going back and forth to R</span></a></li><li><a class="tocitem" href="#Utility-Functions"><span>Utility Functions</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>The RLEVectors Types and Methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>The RLEVectors Types and Methods</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/phaverty/RLEVectors.jl/blob/master/docs/src/api.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="The-RLEVectors-Types-and-Methods"><a class="docs-heading-anchor" href="#The-RLEVectors-Types-and-Methods">The RLEVectors Types and Methods</a><a id="The-RLEVectors-Types-and-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#The-RLEVectors-Types-and-Methods" title="Permalink"></a></h1><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#RLEVectors.RLEDataFrame"><code>RLEVectors.RLEDataFrame</code></a></li><li><a href="#RLEVectors.RLEVector"><code>RLEVectors.RLEVector</code></a></li><li><a href="#RLEVectors.disjoin"><code>RLEVectors.disjoin</code></a></li><li><a href="#RLEVectors.disjoin_length"><code>RLEVectors.disjoin_length</code></a></li><li><a href="#RLEVectors.inverse_ree"><code>RLEVectors.inverse_ree</code></a></li><li><a href="#RLEVectors.numruns"><code>RLEVectors.numruns</code></a></li><li><a href="#RLEVectors.rangeMeans"><code>RLEVectors.rangeMeans</code></a></li><li><a href="#RLEVectors.ree"><code>RLEVectors.ree</code></a></li><li><a href="#RLEVectors.rep"><code>RLEVectors.rep</code></a></li><li><a href="#RLEVectors.tapply"><code>RLEVectors.tapply</code></a></li></ul><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="RLEVectors.RLEVector" href="#RLEVectors.RLEVector"><code>RLEVectors.RLEVector</code></a> — <span class="docstring-category">Type</span></header><section><div><p><strong>RLEVectors</strong></p><p><code>RLEVectors</code> is an alternate implementation of the Rle type from Bioconductor&#39;s IRanges package by H. Pages, P. Aboyoun and M. Lawrence. RLEVectors represent a vector with repeated values as the ordered set of values and repeat extents. In the field of genomics, data of various types measured across the ~3 billion letters in the human genome can often be represented in a few thousand runs. It is useful to know the bounds of genome regions covered by these runs, the values associated with these runs, and to be able to perform various mathematical operations on these values.</p><p><code>RLEVectors</code> can be created from a single vector or a vector of values and a vector of run ends. In either case runs of values or zero length runs will be compressed out. RLEVectors can be expanded to a full vector with <code>collect</code>.</p><p><strong>Aliases</strong></p><p>Several aliases are defined for specific types of RLEVector (or collections thereof).</p><pre><code class="nohighlight hljs">FloatRle              RLEVector{Float64,UInt32}
IntegerRle            RLEVector{Int64,UInt32}
BoolRle               RLEVector{Bool,UInt32}
StringRle             RLEVector{String,UInt32}
RLEVectorList{T1,T2}  Vector{ RLEVector{T1,T2} }</code></pre><p><strong>Constructors</strong></p><p><code>RLEVector</code>s can be created by specifying a vector to compress or the runvalues and run ends.</p><pre><code class="nohighlight hljs">x = RLEVector([1,1,2,2,3,3,4,4,4])
x = RLEVector([4,5,6],[3,6,9])</code></pre><p><strong>Describing <code>RLEVector</code> objects</strong></p><p><code>RLEVector</code>s implement the usual descriptive functions for an array as well as some that are specific to the type.</p><ul><li><code>length(x)</code> The full length of the vector, uncompressed</li><li><code>size(x)</code> Same as <code>length</code>, as for any other vector</li><li><code>size(x,dim)</code> Returns <code>(length(x),1) for dim == 1</code></li><li><code>starts(x)</code> The index of the beginning of each run</li><li><code>widths(x)</code> The width of each run</li><li><code>ends(x)</code> The index of the end of each run</li><li><code>values(x)</code> The data value for each run</li><li><code>isempty(x)</code> Returns boolean, as for any other vector</li><li><code>nrun(x)</code> Returns the number of runs represented in the array</li><li><code>eltype(x)</code> Returns the element type of the runs</li><li><code>endtype(x)</code> Returns the element type of the run ends</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phaverty/RLEVectors.jl/blob/e59e46ae4d070b56997ea83ec23beb42baa9f58c/src/RLEVector-type.jl#L3-L49">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RLEVectors.RLEDataFrame" href="#RLEVectors.RLEDataFrame"><code>RLEVectors.RLEDataFrame</code></a> — <span class="docstring-category">Type</span></header><section><div><p>An RLEDataFrame extends DataFrame and contains a colection of like-length and like-type     RLEVectors. In a way, this creates a type like an RLE matrix. But, we deliberately     avoid the complexity of matrix operations, such as factorization. It is expected     that most operations will be column-wise. Based on RleDataFrame from Bioconductor&#39;s     <code>genoset</code> package (also by Peter Haverty).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">x = RLEDataFrame( [RLEVector([1, 1, 2]), RLEVector([2, 2, 2])], [:a, :b])
y = RLEDataFrame( [RLEVector([5])],[:a] )
z = RLEDataFrame( a=RLEVector([5,2,2]), b=RLEVector([4,4,4])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phaverty/RLEVectors.jl/blob/e59e46ae4d070b56997ea83ec23beb42baa9f58c/src/RLEDataFrame-type.jl#L3-L15">source</a></section></article><h2 id="Standard-Vector-API-methods"><a class="docs-heading-anchor" href="#Standard-Vector-API-methods">Standard Vector API methods</a><a id="Standard-Vector-API-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Standard-Vector-API-methods" title="Permalink"></a></h2><h2 id="Working-with-runs"><a class="docs-heading-anchor" href="#Working-with-runs">Working with runs</a><a id="Working-with-runs-1"></a><a class="docs-heading-anchor-permalink" href="#Working-with-runs" title="Permalink"></a></h2><p><code>RLEVectors.jl</code> has a collection of functions for working with runs in standard vectors. These are mostly for internal use, but are exported as they may be of general use.</p><article class="docstring"><header><a class="docstring-binding" id="RLEVectors.numruns" href="#RLEVectors.numruns"><code>RLEVectors.numruns</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">numruns(x)</code></pre><p>Count the number of runs of repeated values present in a vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phaverty/RLEVectors.jl/blob/e59e46ae4d070b56997ea83ec23beb42baa9f58c/src/runs.jl#L3-L7">source</a></section><section><div><pre><code class="nohighlight hljs">numruns(runvalues, runends)</code></pre><p>Given run values and run ends for a RLEVector, determine the number of runs that would     be present if it were re-compressed. RLEVectors.jl does this operation after modifying     an RLEVector, for example.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phaverty/RLEVectors.jl/blob/e59e46ae4d070b56997ea83ec23beb42baa9f58c/src/runs.jl#L48-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RLEVectors.ree" href="#RLEVectors.ree"><code>RLEVectors.ree</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ree(x)</code></pre><p>Run End Encode a vector</p><p>Like RLE, but returns (runvalues,runends) rather than (runvalues,runlengths)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phaverty/RLEVectors.jl/blob/e59e46ae4d070b56997ea83ec23beb42baa9f58c/src/runs.jl#L20-L26">source</a></section><section><div><pre><code class="nohighlight hljs">ree(runvalues, runends)
ree!(runvalues, runends)
ree!(x::RLEVector)</code></pre><p>Tidy up an existing (mostly) Run End Encoded vector, dropping zero length runs and fixing any adjacent identical values. <code>RLEVectors.jl</code> does this operation after modifying an RLEVector, for example.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phaverty/RLEVectors.jl/blob/e59e46ae4d070b56997ea83ec23beb42baa9f58c/src/runs.jl#L77-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RLEVectors.inverse_ree" href="#RLEVectors.inverse_ree"><code>RLEVectors.inverse_ree</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">inverse_ree(rle)</code></pre><p>Uncompress the runs and runends of an RLEVector.</p><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">collect(rle)
inverse_ree( runvalues(rle), runends(rle) )</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phaverty/RLEVectors.jl/blob/e59e46ae4d070b56997ea83ec23beb42baa9f58c/src/runs.jl#L126-L134">source</a></section></article><h2 id="Working-with-run-boundaries-/-ranges"><a class="docs-heading-anchor" href="#Working-with-run-boundaries-/-ranges">Working with run boundaries / ranges</a><a id="Working-with-run-boundaries-/-ranges-1"></a><a class="docs-heading-anchor-permalink" href="#Working-with-run-boundaries-/-ranges" title="Permalink"></a></h2><p>We define some functions for comparing bins defined by our run end values.</p><article class="docstring"><header><a class="docstring-binding" id="RLEVectors.disjoin" href="#RLEVectors.disjoin"><code>RLEVectors.disjoin</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">disjoin(x, y)</code></pre><p>Takes runends from two RLEVectors, make one new runends breaking the pair into non-overlapping runs. Basically, this is an optimized <code>sort!(unique([x,y])))</code>. This is useful when comparing two RLEVector objects. The values corresponding to each disjoint run in <code>x</code> and <code>y</code> can then be compared directly.</p><p><strong>Returns</strong></p><p>An integer vector, of a type that is the promotion of the eltypes of the runends of x and y.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">x = [2, 4, 6]
y = [3, 4, 5, 6]
disjoin(x,y)
5-element Array{Int64}(1):
 2
 3
 4
 5
 6</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phaverty/RLEVectors.jl/blob/e59e46ae4d070b56997ea83ec23beb42baa9f58c/src/ranges.jl#L28-L49">source</a></section><section><div><pre><code class="nohighlight hljs">disjoin(rle_x, rle_y)</code></pre><p><strong>Examples</strong></p><pre><code class="language-julia hljs">x = RLEVector([1,1,2,2,3,3])
y = RLEVector([1,1,1,2,3,4])
disjoin(x,y)
([2,3,4,5,6],[1,2,2,3,3],[1,1,2,3,4])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phaverty/RLEVectors.jl/blob/e59e46ae4d070b56997ea83ec23beb42baa9f58c/src/ranges.jl#L88-L98">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="RLEVectors.disjoin_length" href="#RLEVectors.disjoin_length"><code>RLEVectors.disjoin_length</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">disjoin_length(x, y)</code></pre><p>Take two runends vectors (strictly increasing integers) and find the number of unique values for the disjoin operation. This is essentially an optimized <code>length(unique( vcat(x, y) ))</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phaverty/RLEVectors.jl/blob/e59e46ae4d070b56997ea83ec23beb42baa9f58c/src/ranges.jl#L3-L8">source</a></section></article><h2 id="split-and-tapply-like-operations"><a class="docs-heading-anchor" href="#split-and-tapply-like-operations">split and tapply -like operations</a><a id="split-and-tapply-like-operations-1"></a><a class="docs-heading-anchor-permalink" href="#split-and-tapply-like-operations" title="Permalink"></a></h2><p>An RLEVector can be used like R&#39;s factor type to apply a function over (contiguous) sections of another vector. For example, here we break a vector into 5 groups and take the average of each group. In the second example, we also scale each mean by the RLE run value corresponding to each group.</p><article class="docstring"><header><a class="docstring-binding" id="RLEVectors.tapply" href="#RLEVectors.tapply"><code>RLEVectors.tapply</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tapply(data_vector, rle, function)
tapply(data_vector, factor_vector, function)</code></pre><p>Map a function to blocks of vector, like <code>tapply</code> in R. The first and second argument must be of the same     length. For the case of a standard vector as the second argument, this vector need not be sorted.</p><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">factor = repeat( [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;,&quot;e&quot;], inner=20 )
rle = RLEVector( factor )
x = collect(1:100)
tapply( x, factor, mean )
tapply( x, rle, mean )</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phaverty/RLEVectors.jl/blob/e59e46ae4d070b56997ea83ec23beb42baa9f58c/src/indexing.jl#L255-L268">source</a></section></article><h2 id="Summaries-on-RLEVectors"><a class="docs-heading-anchor" href="#Summaries-on-RLEVectors">Summaries on RLEVectors</a><a id="Summaries-on-RLEVectors-1"></a><a class="docs-heading-anchor-permalink" href="#Summaries-on-RLEVectors" title="Permalink"></a></h2><p>Often we want to summarize sections of our RLEVectors. For example, if the RLEVector represent data along a genome, what are the average values associated with each of a set of regions/genes?</p><article class="docstring"><header><a class="docstring-binding" id="RLEVectors.rangeMeans" href="#RLEVectors.rangeMeans"><code>RLEVectors.rangeMeans</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">rangeMeans(ranges::Vector{UnitRange{T}}, rle::RLEVector)

Subset an RLEVector by one or more ranges, returning the average value within each range. Really, an
optimized `[ mean(x[ r ]) for r in ranges ]`.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phaverty/RLEVectors.jl/blob/e59e46ae4d070b56997ea83ec23beb42baa9f58c/src/ranges.jl#L148-L153">source</a></section></article><h2 id="Going-back-and-forth-to-R"><a class="docs-heading-anchor" href="#Going-back-and-forth-to-R">Going back and forth to R</a><a id="Going-back-and-forth-to-R-1"></a><a class="docs-heading-anchor-permalink" href="#Going-back-and-forth-to-R" title="Permalink"></a></h2><pre><code class="language-julia hljs">using RCall
x = RLEVector([1,1,2,2,1,1,3,4])
y = RObject(x)
@rput y
R&quot;z = y + 2L&quot;
@rget z</code></pre><h2 id="Utility-Functions"><a class="docs-heading-anchor" href="#Utility-Functions">Utility Functions</a><a id="Utility-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Utility-Functions" title="Permalink"></a></h2><p>We also define some utility functions for working with repeated values and binary searching in bins/sorted integers like our run end values.</p><article class="docstring"><header><a class="docstring-binding" id="RLEVectors.rep" href="#RLEVectors.rep"><code>RLEVectors.rep</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">rep(x::Union{Any,Vector}; each::Union{Int,Vector{Int}} = ones(Int,length(x)), times::Int = 1)</code></pre><p>Construct a vector of repeated values, just like R&#39;s <code>rep</code> function. We do not have a <code>length_out</code> argument at this time.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">rep([&quot;Go&quot;, &quot;Fight&quot;, &quot;Win&quot;], times=2)

# output
6-element Array{String,1}:
 &quot;Go&quot;
 &quot;Fight&quot;
 &quot;Win&quot;
 &quot;Go&quot;
 &quot;Fight&quot;
 &quot;Win&quot;</code></pre><pre><code class="language-julia hljs">rep([&quot;A&quot;, &quot;B&quot;, &quot;C&quot;], each=3)

# output
9-element Array{String,1}:
 &quot;A&quot;
 &quot;A&quot;
 &quot;A&quot;
 &quot;B&quot;
 &quot;B&quot;
 &quot;B&quot;
 &quot;C&quot;
 &quot;C&quot;
 &quot;C&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phaverty/RLEVectors.jl/blob/e59e46ae4d070b56997ea83ec23beb42baa9f58c/src/utils.jl#L1-L37">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>searchsortedfirst(v::AbstractVector, x::AbstractVector)</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>searchsortedfirst(v::AbstractVector, x::AbstractVector, lo::Int, hi::Int)</code>. Check Documenter&#39;s build log for details.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../TODO/">« TODO list</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Saturday 13 January 2024 18:30">Saturday 13 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
